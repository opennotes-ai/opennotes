# Open Notes Staging Environment Configuration
#
# This template shows staging environment settings that mirror production
# but use test credentials and more verbose logging for debugging.
# Copy to .env.yaml and customize with your staging credentials.

# ============================================================================
# CORE ENVIRONMENT
# ============================================================================

ENVIRONMENT: staging
SERVICE: all
DEBUG: false
LOG_LEVEL: INFO

# ============================================================================
# DATABASE - PostgreSQL
# ============================================================================

POSTGRES_DB: opennotes_staging
POSTGRES_USER: opennotes_staging
POSTGRES_PASSWORD: CHANGE_THIS_IN_STAGING
DATABASE_URL: "postgresql+asyncpg://opennotes_staging:CHANGE_THIS_IN_STAGING@postgres:5432/opennotes_staging"

# ============================================================================
# CACHE - Redis
# ============================================================================

REDIS_URL: "redis://redis:6379/1"
REDIS_DB: 1
REDIS_MAX_CONNECTIONS: 20

# ============================================================================
# MESSAGE BROKER - NATS
# ============================================================================

NATS_URL: "nats://nats:4222"
NATS_STREAM_NAME: OPENNOTES_STAGING
NATS_CONSUMER_NAME: opennotes-server

# ============================================================================
# BACKEND SERVER
# ============================================================================

SERVER_HOST: 0.0.0.0
SERVER_PORT: 8000
OPENNOTES_SERVICE_URL: "http://opennotes-server:8000"
PROJECT_NAME: "Open Notes Scoring API - Staging"
VERSION: 1.0.0

# Staging CORS origins (update with your staging domain)
CORS_ORIGINS: "https://staging.example.com,https://staging-admin.example.com"

# Worker configuration (production-like)
MAX_WORKERS: 3
WORKER_ENABLED: true
SCORING_ENABLED: true

# ============================================================================
# DISCORD BOT
# ============================================================================

DISCORD_TOKEN: your_staging_discord_bot_token_here
DISCORD_CLIENT_ID: your_staging_discord_client_id_here
# Public key must be exactly 64 hex characters (32 bytes) - get from Discord Developer Portal
DISCORD_PUBLIC_KEY: "0000000000000000000000000000000000000000000000000000000000000000"
DISCORD_APPLICATION_ID: your_staging_discord_application_id_here

# Discord bot API key for server authentication
OPENNOTES_API_KEY: your_staging_api_key_here

NODE_ENV: production
PORT: 3000

# ============================================================================
# SECURITY
# ============================================================================

# Staging JWT secret (generate with: openssl rand -hex 32)
JWT_SECRET_KEY: CHANGE_THIS_GENERATE_WITH_OPENSSL_RAND_HEX_32
JWT_ALGORITHM: HS256
ACCESS_TOKEN_EXPIRE_MINUTES: 30
REFRESH_TOKEN_EXPIRE_DAYS: 7

# Rate limiting (production settings)
RATE_LIMIT_ENABLED: true
RATE_LIMIT_PER_MINUTE: 60
WEBHOOK_RATE_LIMIT_PER_GUILD: 100

# ============================================================================
# MONITORING & OBSERVABILITY
# ============================================================================

ENABLE_METRICS: true
ENABLE_TRACING: true
ENABLE_JSON_LOGGING: true
ENABLE_CONSOLE_TRACING: false

OTLP_ENDPOINT: "http://tempo:4317"

# ============================================================================
# ENCRYPTION KEYS (REQUIRED)
# ============================================================================

# Fernet key for credential encryption
# Generate with: python -c 'from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())'
CREDENTIALS_ENCRYPTION_KEY: CHANGE_THIS_GENERATE_FERNET_KEY

# Master encryption key for LLM API keys (32 bytes, base64)
# Generate with: python -c 'import secrets, base64; print(base64.urlsafe_b64encode(secrets.token_bytes(32)).decode())'
ENCRYPTION_MASTER_KEY: CHANGE_THIS_GENERATE_32_BYTE_BASE64_KEY

# ============================================================================
# DOCKER & DEPLOYMENT
# ============================================================================

IMAGE_TAG: staging
REGISTRY: ghcr.io
IMAGE_REPO: opennotes-ai/multiverse

# ============================================================================
# DEVELOPMENT TOOLS
# ============================================================================

TESTING: 0
